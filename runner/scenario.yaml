constants:
  music1: data/music-test1.mp3
  music2: data/music-test2.mp3
  music3: data/music-test3.wav

  rock:
    - $music1
    - $music2
    - $music3


  lockerPinNum: 21
  lockerPinLowEvent: busy
  lockerPinHighEvent: idle

  relay1PinNum: 14
  relay1PinValueBusy: 1
  relay1PinValueIdle: 0

  relay2PinNum: 10
  relay3PinNum: 9


events:

  _START_:
    type: sequence
    group:

    - type: pinInit
      num: $lockerPinNum
      direction: in
      edge: both
      pull: up

    - type: pinInit
      num: $relay1PinNum
      direction: out

    - type: pinMonitor
      num: $lockerPinNum
      persist: true
      high:
        type: emit
        event: $lockerPinHighEvent
      low:
        type: emit
        event: $lockerPinLowEvent

  busy:
    type: sequence
    group:
    - type: killAll
    - type: parallel
      group:
      - type: suspend
        event: busy
        suspend: true
      - type: suspend
        event: idle
        suspend: false

      - type: loop
        count: infinite
        action:
          type: sequence
          group:
          - type: pinOutput
            num: $relay1PinNum
            value:
              function: randomInt
              min: 0
              max: 1
          - type: sleep
            seconds:
              function: randomFloat
              min: 0.1
              max: 0.25

  idle:
    type: sequence
    group:
    - type: killAll
    - type: parallel
      group:
      - type: suspend
        event: busy
        suspend: false
      - type: suspend
        event: idle
        suspend: true
      - type: pinOutput
        num: $relay1PinNum
        value: $relay1PinValueIdle

